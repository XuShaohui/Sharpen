# 代码执行漏洞

应用需要调用系统函数执行命令时，当用户可以控制输入的参数，则就可能存在代码执行漏洞。

各语言相关函数：

* PHP：eval()、assert()、preg_replace()

* python：exec()、system()
* JAVA：没有类似于前面两者的函数，但是有反射机制，并且有基于反射机制的表达式引擎，如：0GNL、SpEL、MVEL等。



## 示例

来到测试页面进行测试，可以看到在传参的时候，传入了两个参数，其中`m_print()`，是否意味着这是一个函数？

![](https://borinboy.oss-cn-shanghai.aliyuncs.com/huan20210823083717.png)

那么我们尝试将参数修改为`phpinfo()`看看。

![](https://borinboy.oss-cn-shanghai.aliyuncs.com/huan20210823084028.png)

并且继续尝试执行php的其他系统调用函数看看结果

```
&b=eval("ls")
```

发现浏览器并没有任何输出，很奇怪，那就查看一下源码。

```
<?php
function m_print(){
        echo '这是一个页面';
}
$_GET['a']($_GET['b']);
?>
```

先准备上班吧。。。