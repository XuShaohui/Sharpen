# 文件包含漏洞

程序在引用文件时，有可能产生漏洞：

* 引用的文件名用户可控
* 引用的文件非官方文件或本身存在漏洞

文件包含漏洞分为两种

* 本地包含漏洞
* 远程包含漏洞



## 本地包含漏洞

被包含的文件在服务器本地。

### 漏洞利用

上传恶意文件（如图片）——利用图片中的恶意代码——get shell

可以读取任意文件

```
http://www.webtester.com/include/file01.php?file=file.txt
```

![](https://borinboy.oss-cn-shanghai.aliyuncs.com/huan20210822181633.png)



可以看到这里`file=file.txt`是将`file.txt`加载出来，那么尝试修改文件名为大写，粗略判断出提供服务的操作系统类型。

![](https://borinboy.oss-cn-shanghai.aliyuncs.com/huan20210822181936.png)

看到这里文件名改为大写之后，页面什么都没有，说明这是一个Linux系统，因为Linux系统是对大小写敏感的，这里可以用nmap扫描一下看看是否是Linux系统。

![](https://borinboy.oss-cn-shanghai.aliyuncs.com/huan20210822182228.png)

扫描结果显示，这里确实是Linux操作系统，那么就可以猜解是否可以读取相关文件。

通过手工尝试不断尝试，发现确实可以读取相关文件，在实战中，也可以通过相关工具对文件和路径进行穷举，以此得到我们想要的结果。

![](https://borinboy.oss-cn-shanghai.aliyuncs.com/huan20210822182651.png)

